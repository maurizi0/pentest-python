#!/bin/bash

# the default container provider is podman
# if you want to use docker instead use "export CONTAINER_PROVIDER=docker"
if [ -z "$CONTAINER_PROVIDER" ]; then
    CONTAINER_PROVIDER=podman
fi

echo "[+] Starting Container"
echo "[+] Usage: $0 [-s /path/to/your/local/share] [<command>]"

SHARE="/tmp/container-share"
if [ ! -z "$1" ] && [ "$1" == "-s" ]; then
    shift
    if [ ! -z "$1" ] && [ -d "$1" ]; then
        SHARE="$1"
        shift
    else
        echo "[!] Invalid share \"$1\". Exiting ..."
        exit 1
    fi
else
    mkdir -p "$SHARE"
fi

echo "[+] Shared folder: local:$SHARE -> container:/share"
echo ""

"$CONTAINER_PROVIDER" run \
    -it --rm \
    -v "$SHARE":/share:rw,Z \
    --cap-add=CAP_NET_RAW \
    pentest-python "$@"
